/* =================================================================
   ChapterWise.css — v10.1 (Light/Dark parity • centered titles • mobile CTA fix)
   - KEEP imports (cards.css still styles the subject cards)
   - Proper light tokens in :root, dark overrides in .dark/[data-theme="dark"]
   - Gradient titles, centered header, subject card centering
   - Mobile CTA dock centers & stretches the button
   ================================================================= */
@import '@/styles/utilities.css';
@import '@/styles/cards.css';

/* ---- Tokens ----------------------------------------------------- */
/* LIGHT THEME (default) */
:root {
  --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;

  --c-bg: #f6f7fb;              /* page background */
  --c-panel: #ffffff;           /* panels/toolbars */
  --c-card-bg: #ffffff;         /* cards */
  --c-text-primary: #0f172a;    /* slate-900 */
  --c-text-secondary: #64748b;  /* slate-500 */
  --c-border: #e2e8f0;          /* slate-200 */
  --c-border-hover: #cbd5e1;    /* slate-300 */

  --c-primary: #2563eb;         /* blue-600 */
  --c-primary-fg: #ffffff;
  --c-primary-dark: #1d4ed8;    /* blue-700 */
  --c-primary-light-bg: rgba(37,99,235,.14);
  --c-primary-tint:     rgba(37,99,235,.08);

  --c-chip-bg: rgba(0,0,0,.04); /* subtle pill bg in light */
  --c-cta-bg: rgba(255,255,255,.80);

  --c-shadow:    0 6px 12px rgba(2,8,23,.06);
  --c-shadow-lg: 0 18px 32px rgba(2,8,23,.12);
}

/* DARK THEME OVERRIDES */
:root.dark, [data-theme="dark"] {
  --c-bg: #0b1220;
  --c-panel: #0f172a;
  --c-card-bg: #0f172a;
  --c-text-primary: #e5e7eb;
  --c-text-secondary: #94a3b8;
  --c-border: #1e293b;
  --c-border-hover: #334155;

  --c-primary: #6aa6ff;
  --c-primary-fg: #0b1220;
  --c-primary-dark: #8ab7ff;
  --c-primary-light-bg: rgba(96,165,250,.16);
  --c-primary-tint:     rgba(96,165,250,.10);

  --c-chip-bg: rgba(255,255,255,.03);
  --c-cta-bg: rgba(11,18,32,.72);

  --c-shadow:    0 6px 12px rgba(0,0,0,.18);
  --c-shadow-lg: 0 18px 32px rgba(0,0,0,.34);
}

html { color-scheme: light dark; }
body {
  background-color: var(--c-bg);
  color: var(--c-text-primary);
  font-family: var(--font-sans);
  transition: background-color .25s ease, color .25s ease;
}

/* ---- Main container & page -------------------------------------- */
.cw-container{
  max-width: 1100px;
  margin: 0 auto;
  padding: 3.25rem 1rem 1.25rem;
}
.cw-page{ width:100%; padding-bottom: 6rem; }
.cw-page.with-cta{ padding-bottom: 8.5rem; }

/* ---- HERO (subject selection screen) ---------------------------- */
.cw-hero{ text-align:center; margin:0 0 1.5rem; padding:0 1rem; }
.cw-hero-title{
  margin:0; font-weight:900; line-height:1.5;
  font-size: clamp(1.9rem, 1.2rem + 2.4vw, 3.1rem);
  background: linear-gradient(90deg,#8b5cf6,var(--c-primary),#22d3ee);
  -webkit-background-clip:text; background-clip:text; color:transparent;
}
.cw-hero-subtitle{
  color:var(--c-text-secondary);
  margin:.4rem auto 0;
  font-size:1.05rem;
  max-width: 56ch;
}

/* ---- Page header (chapter list screen) -------------------------- */
.cw-header{
  display:grid; grid-template-columns:auto 1fr auto;
  align-items:center; gap:1rem; margin:0 0 1.2rem;
}
.back-button{ justify-self:start; }
.theme-toggle{ justify-self:end; }

.cw-header-content{
  grid-column:2; justify-self:center; text-align:center; min-width:0;
}
.view-title{
  margin:0; font-weight:900; line-height:1.4;
  font-size: clamp(1.8rem, 1.2rem + 2vw, 2.75rem);
  background: linear-gradient(90deg,#8b5cf6,var(--c-primary),#22d3ee);
  -webkit-background-clip:text; background-clip:text; color:transparent;
}
.view-subtitle{ margin:.25rem 0 0; color:var(--c-text-secondary); font-size:1.05rem }

/* Buttons */
.back-button,.theme-toggle{
  display:inline-flex; align-items:center; justify-content:center; gap:.5rem;
  height:44px; padding:0 .65rem; border-radius:12px; border:1px solid var(--c-border);
  color:var(--c-text-secondary); background:transparent; cursor:pointer;
  transition: background-color .2s, border-color .2s, color .2s, transform .02s;
}
.back-button{ padding-left:.4rem; padding-right:.85rem }
.theme-toggle{ width:44px; padding:0 }
.back-button:hover,.theme-toggle:hover{ background:var(--c-panel); color:var(--c-text-primary); border-color:var(--c-border-hover) }
.back-button:active,.theme-toggle:active{ transform:translateY(1px) }
.back-button:focus-visible,.theme-toggle:focus-visible{
  outline:3px solid var(--c-primary); outline-offset:2px; box-shadow:0 0 0 6px var(--c-primary-light-bg);
}

/* ---- Toolbar ---------------------------------------------------- */
.cw-toolbar{
  display:flex; flex-wrap:wrap; gap:1rem; align-items:center; justify-content:space-between;
  padding:1rem; background:var(--c-panel); border-radius:16px; border:1px solid var(--c-border);
  box-shadow:var(--c-shadow); margin:0 0 1.1rem;
}
.cw-toolbar-group{ display:flex; flex-wrap:wrap; gap:1rem; align-items:center }

.cw-mode-row{ display:flex; gap:.5rem; background:var(--c-chip-bg); padding:.4rem; border-radius:999px }
.cw-mode-pill{
  padding:.6rem 1.2rem; border:none; border-radius:999px; background:transparent;
  color:var(--c-text-secondary); font-weight:800; cursor:pointer; transition:all .22s ease;
}
.cw-mode-pill:hover{ background:var(--c-card-bg); color:var(--c-text-primary) }
.cw-mode-pill.active{ background:var(--c-primary); color:var(--c-primary-fg); box-shadow:0 6px 18px -6px rgba(0,0,0,.18) }
.cw-mode-pill:focus-visible{ outline:3px solid var(--c-primary); outline-offset:2px }

.cw-count-control{ display:flex; align-items:center; gap:.75rem }
.cw-count-label{ font-weight:800; color:var(--c-text-secondary) }
.cw-count-control input[type="number"]{
  width:80px; text-align:center; font-weight:800; font-size:1rem;
  padding:.6rem; border-radius:10px; border:1px solid var(--c-border);
  background:var(--c-panel); color:var(--c-text-primary);
  transition:border-color .2s, box-shadow .2s;
}
.cw-count-control input[type="number"]:hover{ border-color:var(--c-border-hover) }
.cw-count-control input[type="number"]:focus-visible{
  border-color:var(--c-primary); box-shadow:0 0 0 3px var(--c-primary-light-bg); outline:0;
}
.cw-count-control input[type="number"]::-webkit-outer-spin-button,
.cw-count-control input[type="number"]::-webkit-inner-spin-button{ -webkit-appearance:none; margin:0 }
.cw-count-control input[type="number"]{ -moz-appearance:textfield }

.cw-bulk-actions{ display:inline-flex; gap:.75rem }
.cw-btn-secondary{
  padding:.6rem 1rem; font-weight:800; border-radius:10px; border:1px solid var(--c-border);
  background:var(--c-panel); color:var(--c-text-secondary); cursor:pointer; transition:all .2s;
}
.cw-btn-secondary:hover{ color:var(--c-primary); border-color:currentColor }
.cw-btn-secondary:focus-visible{ outline:3px solid var(--c-primary); outline-offset:2px }

/* ---- SUBJECT GRID — gentle overrides only ---------------------- */
.subject-grid{
  display:grid;
  grid-template-columns: repeat(4, minmax(0,1fr));
  gap:16px;
  margin-top:.5rem;
}
@media (max-width:1200px){ .subject-grid{ grid-template-columns: repeat(3, minmax(0,1fr)); } }
@media (max-width:900px) { .subject-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
@media (max-width:560px) { .subject-grid{ grid-template-columns: 1fr; } }

/* Center icon + text without fighting cards.css */
.subject-card{
  display:flex !important;
  flex-direction:column !important;
  align-items:center !important;
  justify-content:center !important;
  text-align:center;
  min-height: 170px;
  gap: .75rem;
}
.subject-card h3,
.subject-card .subject-name,
.subject-card .title{
  margin:0; font-weight:900; line-height:1.25; text-align:center;
}

/* ---- CHAPTER GRID ---------------------------------------------- */
.cw-loading-indicator{ text-align:center; padding:3.2rem 0; font-weight:800; color:var(--c-text-secondary) }

.chapter-grid{
  display:grid;
  grid-template-columns: repeat(3, minmax(0,1fr));
  gap:12px;
}
@media (max-width:1024px){ .chapter-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
@media (max-width:600px) { .chapter-grid{ grid-template-columns: 1fr; } }

.chapter-card{
  display:flex; align-items:center; gap:.9rem; padding:.9rem 1.05rem;
  background:var(--c-card-bg); border:1px solid var(--c-border); border-radius:12px;
  cursor:pointer; text-align:left; transition:border-color .2s, background-color .2s, transform .02s;
}
.chapter-card:hover{ border-color:var(--c-border-hover) }
.chapter-card:active{ transform:translateY(1px) }
.chapter-card:focus-visible{ outline:3px solid var(--c-primary); outline-offset:2px }
.chapter-card.selected{ border-color:var(--c-primary); background:var(--c-primary-tint) }
.chapter-card.selected .chapter-name{ color:var(--c-primary) }

.checkbox-icon{
  flex-shrink:0; width:24px; height:24px; display:grid; place-items:center;
  border-radius:8px; border:2px solid var(--c-border); background:var(--c-panel);
  transition:all .2s ease; color:#fff;
}
.chapter-card.selected .checkbox-icon{ background:var(--c-primary); border-color:var(--c-primary) }
.chapter-name{ font-weight:800; color:var(--c-text-primary); line-height:1.4; overflow-wrap:anywhere }

/* ---- CTA Dock --------------------------------------------------- */
.cw-cta-dock{
  position:fixed; left:50%; transform:translateX(-50%);
  bottom:calc(1rem + env(safe-area-inset-bottom,0px));
  width:min(640px,calc(100% - 2rem));
  display:flex; align-items:center; justify-content:space-between; gap:1rem;
  padding:.75rem 1.25rem; border-radius:16px;
  background: var(--c-cta-bg);
  backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
  border:1px solid var(--c-border); box-shadow:var(--c-shadow-lg); z-index:60;
}
.cw-cta-summary{
  font-weight:800; font-size:.95rem; color:var(--c-text-primary);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.cw-cta-summary strong{ color:var(--c-primary) }
.cw-cta-button{
  flex-shrink:0; padding:.85rem 1.5rem; border-radius:12px; border:1px solid transparent;
  background:var(--c-primary); color:var(--c-primary-fg); font-weight:900; cursor:pointer;
  transition:background-color .2s, transform .02s;
}
.cw-cta-button:hover{ background:var(--c-primary-dark) }
.cw-cta-button:active{ transform:scale(.98) }
.cw-cta-button:disabled{ opacity:.6; cursor:not-allowed; background:var(--c-primary-light-bg); color:var(--c-text-secondary) }

/* ---- Responsive tightening ------------------------------------- */
@media (max-width: 768px){
  .cw-toolbar{ flex-direction:column; align-items:stretch }
  .cw-toolbar-group{ justify-content:space-between }
}
@media (max-width: 600px){
  .cw-container{ padding-top:2.2rem }
  .cw-header{ grid-template-columns: 1fr auto 1fr; }
  .back-button{ justify-self:start }
  .theme-toggle{ justify-self:end }
  .cw-header-content{ grid-column:2 }
  .cw-toolbar-group{ flex-direction:column; align-items:stretch; gap:.85rem }
  .cw-mode-row{ justify-content:center }
  .cw-count-control{ justify-content:space-between }
  .cw-bulk-actions{ display:grid; grid-template-columns:1fr 1fr; gap:.6rem }
  .cw-cta-summary{ display:none }
  .cw-cta-button{ width:100% }
}

/* === Mobile CTA centering fix (overrides) ======================== */
@media (max-width: 600px){
  .cw-cta-dock{
    left:  max(10px, env(safe-area-inset-left, 0px));
    right: max(10px, env(safe-area-inset-right, 0px));
    transform: none;             /* stop translate centering */
    width: auto;                 /* let left/right control width */
    bottom: calc(.75rem + env(safe-area-inset-bottom, 0px));
    justify-content: center;     /* center the single button */
    padding: .65rem .8rem;
    gap: .75rem;
  }
}
@media (max-width: 360px){
  .cw-cta-dock{ padding: .55rem .7rem }
}

/* ---- A11y & Print ---------------------------------------------- */
*:focus-visible{ outline:2px solid var(--c-primary); outline-offset:2px; border-radius:4px }
.cw-mode-pill:focus-visible,
.cw-btn-secondary:focus-visible,
.chapter-card:focus-visible,
.back-button:focus-visible,
.theme-toggle:focus-visible{ outline-offset:4px }

@media (prefers-reduced-motion:reduce){
  *,*::before,*::after{ animation:none !important; transition:none !important; scroll-behavior:auto !important }
}
@media print{
  .cw-cta-dock,.cw-toolbar,.theme-toggle,.back-button{ display:none !important }
  .chapter-card{ box-shadow:none !important; border-color:#ddd !important; break-inside:avoid }
}
